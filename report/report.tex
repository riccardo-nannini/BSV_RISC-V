\documentclass[12pt,oneside,a4paper]{article}

\usepackage[backend=biber,style=numeric]{biblatex}
\usepackage{xcolor}
\usepackage{todonotes}
\usepackage{amsmath}
\usepackage{multicol}
\usepackage{caption}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{listings}
\lstset{
	frame=top,frame=bottom,
	language=C,
	basicstyle=\small\normalfont,
	xleftmargin=\parindent,
	keywordstyle=\color{green!40!black},
	%  commentstyle=\itshape\color{purple!40!black},
	%  identifierstyle=\color{blue},
	%  stringstyle=\color{orange},
	morekeywords={in, globaldata, procedure, input, output, behavior, end, XOR, NOT, AND}, % keyword to highlight
	%  captionpos=t,
	tabsize=2,
	numbers=left,
	stepnumber=1,                   % the step between two line-numbers.        
	numbersep=5pt,
	framexleftmargin=10pt,
	title=\lstname,
	captionpos=t,
	showspaces=false,
}
\DeclareCaptionFormat{listing}{\rule{\dimexpr\textwidth\relax}{0.4pt}\par\vskip1pt#1#2#3}
\captionsetup[lstlisting]{format=listing,singlelinecheck=false, margin=0pt,labelsep=space,labelfont=bf}

\usepackage{booktabs}
\usepackage[noabbrev,capitalise]{cleveref}
\crefname{listing}{algorithm}{algorithms}
\Crefname{listing}{Algorithm}{Algorithms}
\renewcommand\lstlistingname{Algorithm}
\def\lstlistingcrefname{Algorithm}
\usepackage{url}

\addbibresource{biblio.bib}

\title{\textbf{RISC-V processors with Bluespec}}

\author{High Performance Processors and System\\ A.Y. 2020/2021\\\\\\\\\textbf{Riccardo Nannini}\\\\\\}

\date{\parbox{\linewidth}{\centering%
		\today\endgraf\bigskip\bigskip\bigskip\bigskip\bigskip
		Tutors: Emanuele Del Sozzo, \endgraf\medskip
		Davide Conficconi \endgraf\bigskip\bigskip
		Professor: Marco Domenico Santambrogio 
		}}
\begin{document}

\begin{titlepage}
	\centering
	\clearpage
	\maketitle
	\thispagestyle{empty}
	\vspace*{1cm}
	\vfill
	\centering
	\includegraphics{logo_polimi.png}\includegraphics{logo_NECST.png}
\end{titlepage}

\tableofcontents
\newpage

\begin{abstract}
Bluespec System Verilog (\textbf{BSV}) is a state-of-the-art Hardware Description Language.
Bluespec compilation toolchain (\textbf{BSC}) has been recently released as open source \cite{bsc}. The goal of the project was investigating the potentiality of said toolchain implementing different \textbf{RISC-V} processors of increasing complexity.\\
\end{abstract}

\section{Introduction} \label{sec:intro}

This report covers chronologically the path that I have followed during the development of this project.
 
It starts from a quick overview on the \textit{RISC-V} ISA, focused on the key ingredients that make this ISA one of the most trend topics in Computer Engineering.

It proceeds with the analysis of the \textit{Bluespec System Verilog} language, outlining its novelties with respect to other hardware description languages, as well as its main features and capabilities. 

The last section is devoted to the development of various RISC-V processor designs, describing in details the characteristics of each processor and motivating the various design choices, starting from a one cycle non pipelined processor and ending with a 6 stage pipelined one enriched with multiple branch predictors.

Everything I have produced within this project (code, scripts, this report itself) is available on GitHub \url{https://github.com/riccardo-nannini/BSV_RISC-V}


\section{RISC-V} \label{sec:risc-v}
\subsection{What is RISC-V}
Since the processor designs will be based on RISC-V, knowing this ISA is fundamental.

RISC-V was born in 2010 at UC Berkley by the work of graduate students Andrew Waterman, Yunsup Lee and professors David Patterson, Krste Asanovic \cite{risc-v_original}, built on the experience gained from the 4 previous major RISC ISA design from UC Berkeley (thus justifying the ‘V’).

For the scope of the project, the focus was put on the User-Level (or Unprivileged) section of the ISA.

As the name suggests, RISC-V belongs to the family of \textbf{RISC} ISAs. In particular, RISC instruction sets are characterized by \textit{small} and \textit{highly optimized} instructions that ease \textit{pipeline} implementation, along with a large number of \textit{general purpose registers}. 

RISC-V, like many other RISC ISAs, is a \textbf{load-store architecture}; this means that, apart from some exceptions, arithmetic and logic instructions operate on register and not on memory directly. Load and store instructions take care of the transit of data from memory to register and vice versa.
\subsection{Instructions set goals}
When the first paper that declared the birth of RISC-V \cite{risc-v_original} was released back in 2011, the authors stated some of the goals that they wanted to achieve when designing this instructions set. In particular the main objectives include, but are not limited to:
\begin{itemize}
	\item Provide a \textit{realistic} but \textit{open} ISA, suitable for direct hardware implementation
	\item Provide a \textbf{small} but \textbf{complete} ISA, that avoids "\textit{over-architecting}" for a particular microarchitecture style or implementation technology.
	\item Support highly-parallel multicore implementations, including heterogeneous multiprocessors
	\item Support an efficient dense \textit{instruction encoding} with variable-length instructions (generally typical of CISC ISAs).
	\item \textbf{base-plus-extension}: provide a set of standard but optional extensions.
	\item Be fully \textit{virtualizable}.
	\item Be simple to subset for educational purpose or to reduce complexity in new implementations.
\end{itemize}
In order to achieve these goals many design choices were taken, sometimes in line with other similar ISAs, sometimes with unusual decisions.

\subsection{Main features}
RISC-V has 2 base variants, \textbf{RV32} and \textbf{RV64}, providing 32-bit or 64-bit user-level address spaces respectively. A 128-bit extension is available but mostly aimed at the future of warehouse scale computing.
\subsubsection{Registers}
RISC-V uses 31 general-purpose registers  {\fontfamily{cmtt}\selectfont{x1-x31}} with  {\fontfamily{cmtt}\selectfont{x0}} hardwired to the costant 0. Moreover, 32 64-bit registers {\fontfamily{cmtt}\selectfont{f0-f31}} holding single or double-precision floating-point values are available as shown in \cref{riscv:registers}

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.8]{risc-v_registers}
	\caption{RISC-V user-level registers (XPRLEN refers to the width of registers in bit (either 32 or 64)}
	\label{riscv:registers}
\end{figure}

There are also two special registers: the \textit{program counter} {\fontfamily{cmtt}\selectfont{pc}} holds the address of the current instruction while the \textit{floating point status register} {\fontfamily{cmtt}\selectfont{fsr}} contains the operating mode and exception status of the floating-point unit.
\subsubsection{Instruction encoding}
\subsubsection{Instruction format}
\subsection{License}
\section{BSV}
\section{Processor designs}
\newpage
\printbibliography

\end{document}


